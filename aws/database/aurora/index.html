

<!DOCTYPE html>
<html>
  <head>
    <title>
	Aurora :: テックまとめ
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2022-05-01T10:56:50 JST">
<meta name="description" content="備忘録用メモサイト">



<title>Aurora :: テックまとめ</title>

<link rel="shortcut icon" href='/images/favicon.png' type="image/x-icon" />

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css">

<script src='https://code.jquery.com/jquery-3.5.1.min.js'></script>

<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel="stylesheet">



<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/layout.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/css/style.main.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/css/style.menu.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/notice.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/tabs.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/panel.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/columns.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/children.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/attachments.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/alert.css'>
<link rel="stylesheet" type="text/css" href='/css/docport.css'>

<script src='/js/docport.js'></script>
<script type="text/javascript">
      var baseurl = "https:\/\/tanakakns.github.io\/";
</script>




    
  </head>

  <body data-url="/aws/database/aurora/"

  class="hidetoc hidenextpage ">

<style type="text/css">
  #debug{
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    line-height: 3.5rem;
    margin-bottom: .35rem;
    padding: 0 2rem;
    position: fixed;
    left: 0;      right: 0;     top: 0;
   
    top:0px;
    
    min-height: 150px;

    background-color: white;
    border: 3px solid red;
    z-index: 10000 ;
    word-wrap: all;
    overflow: auto;
  }
</style>
 


    
    
    <header style="">
        <div>
    
    <div class="burger ">
        <a href="javascript:void(0);" style="font-size:15px;" onclick="$('article > aside').toggleClass('responsive')">&#9776;</a>
    </div>
    

    <div>

		
	
			
		
	    	<a class='baselink' href='https://tanakakns.github.io/'>テックまとめ</a>
	  	
	</div>

</div>
    </header>
    

    <article>
      
      <aside class="">
        

		
	
			
		
	    	
	  	
	<div id="close_menu">
  <a href="javascript:void(0);" style="font-size:15px;" onclick="$('article > aside').toggleClass('responsive')">
      <i class="fa fa-lg fa-times"></i>
  </a>
</div>

<ul class="menu">

    <li data-nav-id="https://tanakakns.github.io/design/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/design/">設計</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/design/principle-practice/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/design/principle-practice/">原理原則・ベストプラクティス</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/design/api-design/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/design/api-design/">API設計</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/design/microservices/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/design/microservices/">マイクロサービス</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/design/clean-architecture/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/design/clean-architecture/">クリーンアーキテクチャ</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/aws/" class="dd-item parent haschildren
        item_level_$level
        ">

      
      
      
      
          <i class="fas fa-chevron-down ddexp"></i>
        
      
          <a href="/aws/">AWS</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/aws/well-architected-framework/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/aws/well-architected-framework/">AWS Well-Architected フレームワーク</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/aws/database/" class="dd-item parent haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/aws/database/">データベース</a>
      
          <i class="fas fa-chevron-down ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/aws/database/aurora/" class="dd-item parent active
        item_level_$level
        ">

      
      
      
      
          <a href="/aws/database/aurora/">Aurora</a>
      
        
      
    </li>
        </ul>
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/gcp/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/gcp/">GCP</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/gcp-aws/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/gcp-aws/">GCP と AWS の比較</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/monitoring/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/monitoring/">監視</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/tools/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/tools/">ツール</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/tools/management-tools/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/tools/management-tools/">管理ツール</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/tools/dev-tools/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/tools/dev-tools/">開発ツール</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/access-control-and-security/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/access-control-and-security/">アクセス制御とセキュリティ</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/">コンピューティングとホスティング</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/compute-engine/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/compute-engine/">Compute Engine</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/kubernetes-engine/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/kubernetes-engine/">Google Kubernetes Engine</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/app-engine/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/app-engine/">App Engine</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/cloud-functions/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/cloud-functions/">Cloud Functions</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/storage/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/storage/">ストレージ</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/">データベース</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/bigquery/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/bigquery/">BigQuery</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/sql/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/sql/">Cloud SQL</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/memorystore/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/memorystore/">Memorystore</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/spanner/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/spanner/">Cloud Spanner</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/">ネットワーキング</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/vpc/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/vpc/">VPC</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/load-balancing/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/load-balancing/">Cloud Load Balancing</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/iap/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/iap/">Identity-Aware Proxy</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/interconnect/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/interconnect/">Cloud Interconnect</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/big-data/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/big-data/">ビッグデータ</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/big-data/pubsub/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/big-data/pubsub/">Cloud Pub/Sub</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/big-data/dataflow/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/big-data/dataflow/">Dataflow</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/machine-learning/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/machine-learning/">機械学習</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/kubernetes/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/kubernetes/">Kubernetes</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/concept/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/concept/">概念整理</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/architecture/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/architecture/">アーキテクチャ</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/kubectl-plugin/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/kubectl-plugin/">kubectl plugin と Krew</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/command/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/command/">コマンド</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/manifest/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/manifest/">マニフェスト</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/application-management/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/application-management/">アプリケーション管理</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/cluster-management/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/cluster-management/">クラスタ管理</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/security/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/security/">セキュリティ</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/istio/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/istio/">Istio</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/istio/basic/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/istio/basic/">入門</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/istio/concept/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/istio/concept/">概念整理</a>
      
        
      
    </li>
        </ul>
    </li>
    



</ul>

		
	
			
		
	    	
	  	
	
      </aside>
      

      <section class="page ">
      
	
		
    
    
    <nav id="ariane" aria-label="breadcrumb">
      <ol class="ariane">
        
  
  	
		
  
  	
		
  
  	
	<li >
      <a class="text-link" href="https://tanakakns.github.io/">
        
      </a>
    </li>
	
  
    <li class="">
      <a class="text-link" href="/aws/">
        AWS
      </a>
    </li>
	
  	
  
    <li class="">
      <a class="text-link" href="/aws/database/">
        データベース
      </a>
    </li>
	
  	
  
    <li class="active">
      
        Aurora
      
    </li>

      </ol>
    </nav>
    
    

    
		
        
		
		
		
		
		
		
		

		
			<h1>Aurora</h1>
        

		
										
		

		
	

	
	
	






	<div class="content">
	    <p><a href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/CHAP_AuroraOverview.html">Amazon Aurora</a>についてまとめる。</p>
<ul>
<li>
<ol>
<li><a href="#1-%E7%89%B9%E5%BE%B4">特徴</a></li>
</ol>
</li>
<li>
<ol start="2">
<li><a href="#2-%E8%A8%AD%E5%AE%9A">設定</a></li>
</ol>
</li>
<li>
<ol start="3">
<li><a href="#3-%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8">ストレージ</a></li>
</ol>
</li>
</ul>
<h2 ref="1-特徴" >1. 特徴</h2><a class="anchor" id="1-特徴"></a>
<ul>
<li>インスタンスとストレージが分離している</li>
<li>ストレージがマルチ AZ HA クラスタ</li>
<li>Protection Groups
<ul>
<li>ストレージは10GBごとに3AZにまたがって6つのコピーを持つ構成（この10GBの塊のことをProtection Group）</li>
</ul>
</li>
<li>BackTrack
<ul>
<li>データ巻き戻し機能</li>
</ul>
</li>
<li>クラスタキャッシュ管理による高速リカバリ
<ul>
<li>プライマリインスタンスが持っているキャッシュを、特定のレプリカと共有することができる機能</li>
<li>リードレプリカがプライマリ昇格した際の性能劣化を防ぐ</li>
</ul>
</li>
<li>並列クエリ（Parallel Query）
<ul>
<li>インスタンス層がやっているクエリ実行などの処理をそのストレージ層のリソースにオフロードして、ストレージ側で処理してしまおうというのが並列クエリ</li>
</ul>
</li>
<li>Global Database
<ul>
<li>ストレージレイヤでのリージョン間レプリケーション</li>
</ul>
</li>
<li>Aurora Serverless
<ul>
<li>インスタンス層が需要に合わせて自動スケールする機能</li>
</ul>
</li>
</ul>
<h2 ref="2-設定" >2. 設定</h2><a class="anchor" id="2-設定"></a>
<p>Terraform リソースベースで記載する。</p>
<h3 ref="21-aws_rds_cluster-と-aws_rds_cluster_instance" >2.1. <code>aws_rds_cluster</code> と <code>aws_rds_cluster_instance</code></h3><a class="anchor" id="21-aws_rds_cluster-と-aws_rds_cluster_instance"></a>
<p>Aurora はクラスタ内に複数インスタンス構築されると、ライターインスタンスとリーダーインスタンスに役割分担され、障害時はリーダーインスタンスがライターインスタンスに昇格する。<br>
なので、 <code>availability_zone</code> にてマルチ AZ 構成となるよう設定する必要がある。</p>
<p><code>aws_rds_cluster</code> の設定は以下の通り。（どうでもいいもの・特殊なものは省略している）</p>
<ul>
<li><code>apply_immediately</code> -&gt; デフォルト・推奨：false
<ul>
<li>クラスタの変更を直ちに適用する(true) or 次回メンテナンスウィンドウで適用するか(false)</li>
</ul>
</li>
<li><code>availability_zones</code> -&gt; 設定不要
<ul>
<li>DB クラスタ内の DB クラスタインスタンスを作成する AZ のリスト</li>
<li>なお、 DB サブネットグループ（ <code>aws_db_subnet_group</code> ）の設定が反映されるため、明示的に設定する必要はない</li>
</ul>
</li>
<li><code>backtrack_window</code> -&gt; 要件がなければデフォルト：0
<ul>
<li>BackTrack（データ巻き戻し機能）の時間幅</li>
<li>0 〜 259200 秒 (72 時間)</li>
</ul>
</li>
<li><code>backup_retention_period</code> -&gt; デフォルト：1
<ul>
<li>バックアップを保持する日数</li>
</ul>
</li>
<li><code>cluster_identifier</code>
<ul>
<li>クラスタの識別子（nameの代わり）</li>
</ul>
</li>
<li><code>copy_tags_to_snapshot</code>
<ul>
<li>クラスタに定義された <code>tags</code> をクラスタから作成したスナップショットにコピーするか否か</li>
</ul>
</li>
<li><code>database_name</code>
<ul>
<li>データベース名</li>
</ul>
</li>
<li><code>db_cluster_parameter_group_name</code>
<ul>
<li>クラスタ内の全ての DB インスタンスに適用されるパラメータグループ</li>
</ul>
</li>
<li><code>db_instance_parameter_group_name</code> -&gt; 利用しない
<ul>
<li>DB インスタンス単体に適用されるパラメータグループ</li>
</ul>
</li>
<li><code>db_subnet_group_name</code>
<ul>
<li>DB インスタンスに関連づける DB サブネットグループ</li>
</ul>
</li>
<li><code>deletion_protection</code> -&gt; 推奨：true
<ul>
<li>DB インスタンスの削除保護を有効にするか否か</li>
</ul>
</li>
<li><code>enable_http_endpoint</code> -&gt; デフォルト・通常：false
<ul>
<li>HTTP エンドポイントを有効にするか否か</li>
</ul>
</li>
<li><code>enabled_cloudwatch_logs_exports</code>
<ul>
<li>CloudWatch Logs にログ出力するログ種別を指定</li>
<li><code>audit</code> 、 <code>error</code> 、 <code>general</code> 、 <code>slowquery</code> 、 <code>postgres</code> から指定（ PostgreSQL は <code>postgres</code> のみ）</li>
</ul>
</li>
<li><code>engine_mode</code> -&gt; 通常要件がない限り設定不要
<ul>
<li>エンジンモードの指定</li>
<li><code>global</code> 、 <code>multimaster</code> 、 <code>parallelquery</code> 、 <code>provisioned</code> 、 <code>serverless</code> から指定</li>
</ul>
</li>
<li><code>engine</code>
<ul>
<li>クラスタで利用するデータベースエンジン名</li>
</ul>
</li>
<li><code>engine_version</code>
<ul>
<li>クラスタで利用するデータベースエンジンのバージョン</li>
</ul>
</li>
<li><code>final_snapshot_identifier</code>
<ul>
<li>クラスタを削除する際に作成するスナップショット名</li>
</ul>
</li>
<li><code>iam_database_authentication_enabled</code> -&gt; デフォルト・通常：false
<ul>
<li>DB アクセス認証をID・パスワード認証ではなく、 IAM 認証にするか否か</li>
</ul>
</li>
<li><code>iam_roles</code> -&gt; 通常不要
<ul>
<li>クラスタに関連づける IAM ロールの ARN リスト</li>
</ul>
</li>
<li><code>kms_key_id</code>
<ul>
<li><code>storage_encrypted</code> を <code>true</code> にした際に利用する KMS キー</li>
</ul>
</li>
<li><code>master_password</code>
<ul>
<li>マスターDBユーザパスワード</li>
</ul>
</li>
<li><code>master_username</code>
<ul>
<li>マスターDBユーザ名</li>
</ul>
</li>
<li><code>port</code>
<ul>
<li>DB ポート</li>
</ul>
</li>
<li><code>preferred_backup_window</code>
<ul>
<li>バックアップウィンドウの時間指定</li>
<li><code>&quot;15:00-16:00&quot;</code> みたいな感じで指定（UTC）</li>
</ul>
</li>
<li><code>preferred_maintenance_window</code>
<ul>
<li>メンテナンスウィンドウの時間指定</li>
<li><code>&quot;sun:16:00-sun:17:00&quot;</code> みたいな感じで指定（UTC）</li>
</ul>
</li>
<li><code>replication_source_identifier</code> -&gt; 通常設定不要
<ul>
<li>リードレプリカのソース DB として使用する DB クラスタまたはインスタンスの ARN を指定</li>
</ul>
</li>
<li><code>skip_final_snapshot</code> -&gt; 推奨：true
<ul>
<li>DB クラスタを削除する際に DB スナップショットを作成するか否か</li>
</ul>
</li>
<li><code>snapshot_identifier</code>
<ul>
<li>DB クラスタをスナップショットから作成する場合に指定するスナップショットの ARN</li>
</ul>
</li>
<li><code>source_region</code> -&gt; 通常設定不要
<ul>
<li>暗号化レプリカ DB クラスタの存在するリージョンを指定</li>
</ul>
</li>
<li><code>storage_encrypted</code> true or false
<ul>
<li>DB クラスタを暗号化するか否か</li>
</ul>
</li>
<li><code>vpc_security_group_ids</code>
<ul>
<li>DB クラスタに関連づける セキュリティグループの ID リスト</li>
</ul>
</li>
</ul>
<p><code>aws_rds_cluster_instance</code> の設定は以下の通り。（どうでもいいもの・特殊なものは省略している）</p>
<ul>
<li><code>identifier</code>
<ul>
<li>DB インスタンスの識別子</li>
</ul>
</li>
<li><code>cluster_identifier</code>
<ul>
<li>DB インスタンスが所属する DB クラスタの識別子</li>
</ul>
</li>
<li><code>engine</code>
<ul>
<li>インスタンスで利用するデータベースエンジン名</li>
</ul>
</li>
<li><code>engine_version</code>
<ul>
<li>インスタンスで利用するデータベースエンジンのバージョン</li>
</ul>
</li>
<li><code>instance_class</code>
<ul>
<li>インスタンスクラス</li>
</ul>
</li>
<li><code>db_subnet_group_name</code>
<ul>
<li>DB インスタンスに関連づける DB サブネットグループ</li>
</ul>
</li>
<li>db_parameter_group_name
<ul>
<li>DB インスタンス単体に適用されるパラメータグループ</li>
</ul>
</li>
<li><code>apply_immediately</code> -&gt; デフォルト・推奨：false
<ul>
<li>データベースの変更を直ちに適用する(true) or 次回メンテナンスウィンドウで適用するか(false)</li>
</ul>
</li>
<li><code>monitoring_role_arn</code>
<ul>
<li>拡張モニタリングメトリクスを CloudWatch Logs へ送信する IAM ロールの ARN</li>
</ul>
</li>
<li><code>monitoring_interval</code> -&gt; デフォルト：0
<ul>
<li>拡張モニタリングメトリクスの収集間隔</li>
<li>0 、　1 、 5 、 10 、 15 、 30 、 60 から選択</li>
</ul>
</li>
<li><code>promotion_tier</code> -&gt; デフォルト：0
<ul>
<li>インスタンスレベルのフェイルオーバーの優先度を指定する項目</li>
<li>tier が低いリーダーは、ライターに昇格する優先度が高くなる</li>
</ul>
</li>
<li><code>availability_zone</code>
<ul>
<li>DB クラスタインスタンスを作成する AZ</li>
</ul>
</li>
<li><code>preferred_backup_window</code>
<ul>
<li>バックアップウィンドウの時間指定</li>
<li><code>&quot;15:00-16:00&quot;</code> みたいな感じで指定（UTC）</li>
</ul>
</li>
<li><code>preferred_maintenance_window</code>
<ul>
<li>メンテナンスウィンドウの時間指定</li>
<li><code>&quot;sun:16:00-sun:17:00&quot;</code> みたいな感じで指定（UTC）</li>
</ul>
</li>
<li><code>auto_minor_version_upgrade</code> -&gt; デフォルト・推奨：true
<ul>
<li>メンテナンスウィンドウでマイナーエンジンアップグレードを行うか否か</li>
</ul>
</li>
<li><code>performance_insights_enabled</code>
<ul>
<li>Performance Insights を有効にするか否か</li>
</ul>
</li>
<li><code>performance_insights_kms_key_id</code>
<ul>
<li><code>performance_insights_enabled</code> を <code>true</code> にした際に利用する KMS キー</li>
</ul>
</li>
<li><code>performance_insights_retention_period</code> -&gt; デフォルト：7
<ul>
<li><code>performance_insights_enabled</code> を <code>true</code> にした際に利用する Performance Insights データの保持期間</li>
<li>7 〜 731 日</li>
</ul>
</li>
<li><code>copy_tags_to_snapshot</code>
<ul>
<li>インスタンスに定義された <code>tags</code> をインスタンスから作成したスナップショットにコピーするか否か</li>
</ul>
</li>
</ul>
<h2 ref="3-ストレージ" >3. ストレージ</h2><a class="anchor" id="3-ストレージ"></a>
<p>Aurora のストレージには以下の2種類がある。</p>
<ol>
<li>ローカルストレージ</li>
<li>クラスタボリューム</li>
</ol>
<h3 ref="31-ローカルストレージ" >3.1. ローカルストレージ</h3><a class="anchor" id="31-ローカルストレージ"></a>
<p>EC2 でいうインスタンスストアに相当し、DB インスタンスクラスに応じてそのサイズは固定値となっている。「一時ストレージ（Temporary storage）」と記載される場合もある。<br>
例えば Aurora MySQL においては、エラーログ、一般ログ、スロークエリログ、監査ログ、や InnoDB 以外の一時テーブルの保存に使用される。</p>
<h3 ref="32-クラスタボリューム" >3.2. クラスタボリューム</h3><a class="anchor" id="32-クラスタボリューム"></a>
<p>永続的にデータを保存するためのストレージで、このストレージは自動的に増加するのが Aurora の特徴。</p>
<h3 ref="33-メトリクス" >3.3. メトリクス</h3><a class="anchor" id="33-メトリクス"></a>
<ul>
<li><code>FreeLocalStorage</code>
<ul>
<li>ローカルストレージの空き容量を示すメトリクス</li>
<li>ストレージ拡張が必要な場合はインスタンスクラスのスケールアップで対応</li>
</ul>
</li>
<li><code>VolumeBytesUsed</code>
<ul>
<li>クラスタボリュームの容量を示すメトリクス</li>
<li>10 GB 単位で自動拡張する</li>
<li>DROP TABLE、DROP DATABASE、TRUNCATETABLE などの SQL ステートメントを実行した場合に billed space つまり VolumeBytesUsed も減少する（Dynamic Resizing）</li>
</ul>
</li>
<li><code>AuroraVolumeBytesLeftTotal</code>
<ul>
<li>クラスタボリュームの確保可能容量の残量を示すメトリクス</li>
<li>最大 128 TiB までクラスタボリュームが自動的に増加するため、例えば 1 TiB の容量を（VolumeBytesUsed で）確保している場合、127 TiB となる</li>
</ul>
</li>
</ul>
		</div>






	
	

      </section>

      
      
    </article>
    
    
    <footer>
      

		
	
			
		
	    	
	  	
	
    </footer>
    



  </body>
</html>
