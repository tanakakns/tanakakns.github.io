

<!DOCTYPE html>
<html>
  <head>
    <title>
	データベース :: テックまとめ
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2021-07-02T21:18:18 JST">
<meta name="description" content="備忘録用メモサイト">



<title>データベース :: テックまとめ</title>

<link rel="shortcut icon" href='/images/favicon.png' type="image/x-icon" />

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css">

<script src='https://code.jquery.com/jquery-3.5.1.min.js'></script>

<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel="stylesheet">



<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/layout.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/css/style.main.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/css/style.menu.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/notice.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/tabs.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/panel.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/columns.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/children.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/attachments.css'>
<link rel="stylesheet" type="text/css" href='https://tanakakns.github.io/sass/shortcodes/alert.css'>
<link rel="stylesheet" type="text/css" href='/css/docport.css'>

<script src='/js/docport.js'></script>
<script type="text/javascript">
      var baseurl = "https:\/\/tanakakns.github.io\/";
</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-42388425-3', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </head>

  <body data-url="/gcp/databases/"

  class="hidetoc hidenextpage ">

<style type="text/css">
  #debug{
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    line-height: 3.5rem;
    margin-bottom: .35rem;
    padding: 0 2rem;
    position: fixed;
    left: 0;      right: 0;     top: 0;
   
    top:0px;
    
    min-height: 150px;

    background-color: white;
    border: 3px solid red;
    z-index: 10000 ;
    word-wrap: all;
    overflow: auto;
  }
</style>
 


    
    
    <header style="">
        <div>
    
    <div class="burger ">
        <a href="javascript:void(0);" style="font-size:15px;" onclick="$('article > aside').toggleClass('responsive')">&#9776;</a>
    </div>
    

    <div>

		
	
			
		
	    	<a class='baselink' href='https://tanakakns.github.io/'>テックまとめ</a>
	  	
	</div>

</div>
    </header>
    

    <article>
      
      <aside class="">
        

		
	
			
		
	    	
	  	
	<div id="close_menu">
  <a href="javascript:void(0);" style="font-size:15px;" onclick="$('article > aside').toggleClass('responsive')">
      <i class="fa fa-lg fa-times"></i>
  </a>
</div>

<ul class="menu">

    <li data-nav-id="https://tanakakns.github.io/design/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/design/">設計</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/design/architecture/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/design/architecture/">アーキテクチャ</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/mac/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/mac/">Mac開発環境</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/mac/os-settings/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/mac/os-settings/">OSの設定</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/mac/homebrew/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/mac/homebrew/">Homebrew</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/mac/asdf/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/mac/asdf/">asdf</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/git/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/git/">Git</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/git/initial-setting/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/git/initial-setting/">初期設定</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/go/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/go/">Go言語</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/go/initial-setting/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/go/initial-setting/">初期設定</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/go/grammar/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/go/grammar/">文法</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/go/naming/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/go/naming/">命名規則</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/go/pattern/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/go/pattern/">パターン</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/database/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/database/">Database</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/database/rdb/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/database/rdb/">RDB</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/aws/" class="dd-item
        item_level_$level
        ">

      
      
      
      
        
      
          <a href="/aws/">AWS</a>
      
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/gcp/" class="dd-item parent haschildren
        item_level_$level
        ">

      
      
      
      
          <i class="fas fa-chevron-down ddexp"></i>
        
      
          <a href="/gcp/">GCP</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/gcp-aws/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/gcp-aws/">GCP と AWS の比較</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/monitoring/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/monitoring/">監視</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/tools/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/tools/">ツール</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/tools/management-tools/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/tools/management-tools/">管理ツール</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/tools/dev-tools/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/tools/dev-tools/">開発ツール</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/access-control-and-security/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/access-control-and-security/">アクセス制御とセキュリティ</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/">コンピューティングとホスティング</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/compute-engine/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/compute-engine/">Compute Engine</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/kubernetes-engine/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/kubernetes-engine/">Google Kubernetes Engine</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/app-engine/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/app-engine/">App Engine</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/computing-hosting/cloud-functions/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/computing-hosting/cloud-functions/">Cloud Functions</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/storage/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/storage/">ストレージ</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/" class="dd-item parent active haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/">データベース</a>
      
          <i class="fas fa-chevron-down ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/bigquery/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/bigquery/">BigQuery</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/sql/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/sql/">Cloud SQL</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/memorystore/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/memorystore/">Memorystore</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/databases/spanner/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/databases/spanner/">Cloud Spanner</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/">ネットワーキング</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/vpc/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/vpc/">VPC</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/load-balancing/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/load-balancing/">Cloud Load Balancing</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/iap/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/iap/">Identity-Aware Proxy</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/networking/interconnect/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/networking/interconnect/">Cloud Interconnect</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/big-data/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/big-data/">ビッグデータ</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/big-data/pubsub/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/big-data/pubsub/">Cloud Pub/Sub</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/big-data/dataflow/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/big-data/dataflow/">Dataflow</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/gcp/machine-learning/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/gcp/machine-learning/">機械学習</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/terraform/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/terraform/">Terraform</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/terraform/basic/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/terraform/basic/">入門</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/docker/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/docker/">Docker</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/docker/basic/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/docker/basic/">入門</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/kubernetes/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/kubernetes/">Kubernetes</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/concept/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/concept/">概念整理</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/architecture/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/architecture/">アーキテクチャ</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/kubectl-plugin/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/kubectl-plugin/">kubectl plugin と Krew</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/command/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/command/">コマンド</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/manifest/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/manifest/">マニフェスト</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/kubernetes/administration/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/kubernetes/administration/">クラスタ管理</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://tanakakns.github.io/istio/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/istio/">Istio</a>
      
        <ul>
              

    <li data-nav-id="https://tanakakns.github.io/istio/basic/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/istio/basic/">入門</a>
      
        
      
    </li>
              

    <li data-nav-id="https://tanakakns.github.io/istio/concept/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/istio/concept/">概念整理</a>
      
        
      
    </li>
        </ul>
    </li>
    



</ul>

		
	
			
		
	    	
	  	
	
      </aside>
      

      <section class="page ">
      
	
		
    
    
    <nav id="ariane" aria-label="breadcrumb">
      <ol class="ariane">
        
  
  	
		
  
  	
	<li >
      <a class="text-link" href="https://tanakakns.github.io/">
        
      </a>
    </li>
	
  
    <li class="">
      <a class="text-link" href="/gcp/">
        GCP
      </a>
    </li>
	
  	
  
    <li class="active">
      
        データベース
      
    </li>

      </ol>
    </nav>
    
    

    
		
        
		
		
		
		
		
		
		

		
			<h1>データベース</h1>
        

		
										
		

		
	

	
	
	






	<div class="content">
	    <p>Cloud SQL、Cloud Spanner、Bare Metal Solution、Cloud Bigtable、Firestore、Memorystore、BigQuery</p>
<p><a href="https://cloud.google.com/products/databases">Google Cloud データベース</a></p>
<table>
<thead>
<tr>
<th style="text-align:left">サービス</th>
<th style="text-align:left">モデル</th>
<th style="text-align:left">提供</th>
<th style="text-align:left">ユースケース</th>
<th style="text-align:left">備考</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="./sql">Cloud SQL</a></td>
<td style="text-align:left">リレーショナル（ SQL ）</td>
<td style="text-align:left">インスタンス</td>
<td style="text-align:left">小規模（TB級）、水平スケーラビリティ不可</td>
<td style="text-align:left"><a href="https://cloud.google.com/sql/docs">doc</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="./spanner">Cloud Spanner</a></td>
<td style="text-align:left">リレーショナル（ SQL ）</td>
<td style="text-align:left">インスタンス？</td>
<td style="text-align:left">大規模（PB級）、水平スケーラビリティ、グローバル分散</td>
<td style="text-align:left"><a href="https://cloud.google.com/spanner/docs">doc</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="./bigtable">Cloud Bigtable</a></td>
<td style="text-align:left">Key-Value（ HBase 互換）</td>
<td style="text-align:left"></td>
<td style="text-align:left">大容量（PB級）、超低レイテンシ（レイテンシが許容されるなら BQ ）</td>
<td style="text-align:left"><a href="https://cloud.google.com/bigtable/docs">doc</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="./firestore-native">Firestore ネイティブモード</a></td>
<td style="text-align:left">ドキュメント（ドキュメントとコレクション）</td>
<td style="text-align:left">サーバレス</td>
<td style="text-align:left">TB級、トランザクション可能、サーバレス、水平スケーラビリティ</td>
<td style="text-align:left"><a href="https://cloud.google.com/firestore/docs">doc</a>、<a href="https://firebase.google.com/products/realtime-database/">Firebase Realtime Database</a>の後継</td>
</tr>
<tr>
<td style="text-align:left"><a href="./firestore-datastore">Firestore Datastore モード</a></td>
<td style="text-align:left">ドキュメント（エンティティと種類）</td>
<td style="text-align:left">サーバレス</td>
<td style="text-align:left">TB級、トランザクション可能、サーバレス、水平スケーラビリティ</td>
<td style="text-align:left"><a href="https://cloud.google.com/firestore/docs/concepts">doc</a>、<a href="https://cloud.google.com/datastore/docs?hl=ja">Datastore</a>の後継</td>
</tr>
<tr>
<td style="text-align:left"><a href="./memorystore">Memorystore</a></td>
<td style="text-align:left">インメモリ</td>
<td style="text-align:left"></td>
<td style="text-align:left">キャッシュ、超低レイテンシ、非永続化</td>
<td style="text-align:left"><a href="https://cloud.google.com/memorystore/docs">doc</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="./bigquery">BigQuery</a></td>
<td style="text-align:left">DWH（ SQL ）</td>
<td style="text-align:left"></td>
<td style="text-align:left">大規模（PB級）なデータアナリティクス</td>
<td style="text-align:left"><a href="https://cloud.google.com/bigquery/docs?hl=ja">doc</a></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="https://cloud.google.com/firestore/docs/firestore-or-datastore?hl=ja#feature_comparison">ネイティブ モードと Datastore モードからの選択</a>
<ul>
<li>モバイルと直接通信の場合はネイティブモード、サーバとの直接通信の場合は Datastore モードが推奨</li>
</ul>
</li>
</ul>
<h2 ref="データ移行" >データ移行</h2><a class="anchor" id="データ移行"></a>
<ul>
<li>gsutil ：オンプレミスデータの転送量が少ない場合
<ul>
<li>Cloud Storage バケットを作成し、データコピー</li>
<li>オンプレミスもしくは別の Cloud Storage リージョンからの転送 <strong>1 TB 未満</strong> の場合</li>
</ul>
</li>
<li><a href="https://cloud.google.com/storage-transfer/docs/overview?hl=ja">Storage Transfer Service</a> ：オンプレミスデータの転送量が多い場合
<ul>
<li>他のクラウドまたはオンプレミスストレージから Cloud Storage バケットにデータを転送またはバックアップするサービス</li>
<li>別の Cloud Storage リージョンからの転送 <strong>1 TB 超</strong> の場合</li>
<li>別のクラウドストレージからの転送の場合</li>
<li>オンプレミスから 1 TB 超のデータを転送する場合は <a href="https://cloud.google.com/storage-transfer/docs/on-prem-overview?hl=ja"><strong>Transfer service for on-premises data</strong></a></li>
</ul>
</li>
<li>Transfer Appliance ：大規模な転送の場合
<ul>
<li>大量のデータ（数百テラバイトから 1 ペタバイトまで）を Google Cloud Platform に安全に移行できるハードウェア アプライアンス</li>
<li>トータルの所用期間は 50 日</li>
</ul>
</li>
<li>BigQuery Data Transfer Service ：あらかじめ設定されたスケジュールに基づき、BigQuery へのデータの移動を自動化するマネージド サービス</li>
</ul>
<h2 ref="firestore-datastore-モード" >Firestore Datastore モード</h2><a class="anchor" id="firestore-datastore-モード"></a>
<h3 ref="コンセプト" >コンセプト</h3><a class="anchor" id="コンセプト"></a>
<ul>
<li>エンティティ
<ul>
<li>エンティティは 1 つ以上の名前付きプロパティを持ち、各プロパティが 1 つ以上の値を持つ</li>
<li>同じ種類のエンティティが同じプロパティを持つとは限らない</li>
<li>エンティティの特定のプロパティの値がすべて同じデータ型である必要はない</li>
</ul>
</li>
<li>プロパティ
<ul>
<li>整数、浮動小数点数、文字列、日付、バイナリデータ のデータ型をサポート</li>
</ul>
</li>
<li>キー</li>
<li>祖先キー
<ul>
<li>そのエンティティの親となるエンティティの主キー</li>
<li>こうすることで、エンティティがツリー構造になる</li>
<li>このツリーを <strong>エンティティグループ</strong> という</li>
</ul>
</li>
<li>エンティティグループ
<ul>
<li>祖先キーとキーから構成されるツリー構造となったエンティティ群</li>
<li>エンティティグループに対する書き込み処理は1秒間1回しか実行できないが、一貫性のあるクエリを実現できる
<ul>
<li>Datastore の提供するクエリは基本的に 結果整合のクエリ だが、エンティティグループにおいては例外で、これがエンティティグループを作る理由</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>RDBMS と比較した場合は以下の対応になる。</p>
<table>
<thead>
<tr>
<th style="text-align:center">RDBMS</th>
<th style="text-align:center">Datastore</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">スキーマ（データベース）</td>
<td style="text-align:center">ネームスペース</td>
</tr>
<tr>
<td style="text-align:center">テーブル</td>
<td style="text-align:center">カインド（種類）</td>
</tr>
<tr>
<td style="text-align:center">レコード</td>
<td style="text-align:center">エンティティ</td>
</tr>
<tr>
<td style="text-align:center">プライマリキー</td>
<td style="text-align:center">キー + 祖先キー</td>
</tr>
</tbody>
</table>
<h3 ref="操作" >操作</h3><a class="anchor" id="操作"></a>
<p>Go 言語の場合で記載する。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">エンティティの作成</span>
<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Task</span> <span style="color:#66d9ef">struct</span> {
        <span style="color:#a6e22e">Category</span>        <span style="color:#66d9ef">string</span>
        <span style="color:#a6e22e">Done</span>            <span style="color:#66d9ef">bool</span>
        <span style="color:#a6e22e">Priority</span>        <span style="color:#66d9ef">float64</span>
        <span style="color:#a6e22e">Description</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`datastore:&#34;,noindex&#34;`</span>
        <span style="color:#a6e22e">PercentComplete</span> <span style="color:#66d9ef">float64</span>
        <span style="color:#a6e22e">Created</span>         <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>
}
<span style="color:#a6e22e">task</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Task</span>{
        <span style="color:#a6e22e">Category</span>:        <span style="color:#e6db74">&#34;Personal&#34;</span>,
        <span style="color:#a6e22e">Done</span>:            <span style="color:#66d9ef">false</span>,
        <span style="color:#a6e22e">Priority</span>:        <span style="color:#ae81ff">4</span>,
        <span style="color:#a6e22e">Description</span>:     <span style="color:#e6db74">&#34;Learn Cloud Datastore&#34;</span>,
        <span style="color:#a6e22e">PercentComplete</span>: <span style="color:#ae81ff">10.0</span>,
        <span style="color:#a6e22e">Created</span>:         <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>(),
}

<span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">エンティティの登録</span><span style="color:#960050;background-color:#1e0010">・</span><span style="color:#a6e22e">更新</span>
<span style="color:#a6e22e">key</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">datastore</span>.<span style="color:#a6e22e">IncompleteKey</span>(<span style="color:#e6db74">&#34;Task&#34;</span>, <span style="color:#66d9ef">nil</span>)
<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Put</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">task</span>)

<span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">エンティティの取得</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">task</span> <span style="color:#a6e22e">Task</span>
<span style="color:#a6e22e">taskKey</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">datastore</span>.<span style="color:#a6e22e">NameKey</span>(<span style="color:#e6db74">&#34;Task&#34;</span>, <span style="color:#e6db74">&#34;sampleTask&#34;</span>, <span style="color:#66d9ef">nil</span>)
<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">taskKey</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">task</span>)

<span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">エンティティの削除</span>
<span style="color:#a6e22e">key</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">datastore</span>.<span style="color:#a6e22e">NameKey</span>(<span style="color:#e6db74">&#34;Task&#34;</span>, <span style="color:#e6db74">&#34;sampletask&#34;</span>, <span style="color:#66d9ef">nil</span>)
<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Delete</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">key</span>)

<span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">一括オペレーション</span><span style="color:#960050;background-color:#1e0010">（</span><span style="color:#a6e22e">バッチ</span><span style="color:#960050;background-color:#1e0010">）</span>
<span style="color:#a6e22e">tasks</span> <span style="color:#f92672">:=</span> []<span style="color:#f92672">*</span><span style="color:#a6e22e">Task</span>{
        {
                <span style="color:#a6e22e">Category</span>:    <span style="color:#e6db74">&#34;Personal&#34;</span>,
                <span style="color:#a6e22e">Done</span>:        <span style="color:#66d9ef">false</span>,
                <span style="color:#a6e22e">Priority</span>:    <span style="color:#ae81ff">4</span>,
                <span style="color:#a6e22e">Description</span>: <span style="color:#e6db74">&#34;Learn Cloud Datastore&#34;</span>,
        },
        {
                <span style="color:#a6e22e">Category</span>:    <span style="color:#e6db74">&#34;Personal&#34;</span>,
                <span style="color:#a6e22e">Done</span>:        <span style="color:#66d9ef">false</span>,
                <span style="color:#a6e22e">Priority</span>:    <span style="color:#ae81ff">5</span>,
                <span style="color:#a6e22e">Description</span>: <span style="color:#e6db74">&#34;Integrate Cloud Datastore&#34;</span>,
        },
}
<span style="color:#a6e22e">keys</span> <span style="color:#f92672">:=</span> []<span style="color:#f92672">*</span><span style="color:#a6e22e">datastore</span>.<span style="color:#a6e22e">Key</span>{
        <span style="color:#a6e22e">datastore</span>.<span style="color:#a6e22e">IncompleteKey</span>(<span style="color:#e6db74">&#34;Task&#34;</span>, <span style="color:#66d9ef">nil</span>),
        <span style="color:#a6e22e">datastore</span>.<span style="color:#a6e22e">IncompleteKey</span>(<span style="color:#e6db74">&#34;Task&#34;</span>, <span style="color:#66d9ef">nil</span>),
}
<span style="color:#a6e22e">keys</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">PutMulti</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">keys</span>, <span style="color:#a6e22e">tasks</span>)
<span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">その他に</span> <span style="color:#a6e22e">GetMulti</span> <span style="color:#960050;background-color:#1e0010">、</span> <span style="color:#a6e22e">DeleteMulti</span> <span style="color:#a6e22e">もある</span>
</code></pre></div><h3 ref="エンティティのエクスポートとインポート" >エンティティのエクスポートとインポート</h3><a class="anchor" id="エンティティのエクスポートとインポート"></a>
<p>バックアップなどのために <a href="https://cloud.google.com/datastore/docs/export-import-entities">エンティティのエクスポートとインポート</a> を実行する場合、以下の方法で <strong>マネージドエクスポート・インポートサービス</strong> を利用できる。</p>
<ul>
<li>Cloud Console</li>
<li>gcloud コマンドライン ツール</li>
<li>Datastore Admin API（REST、RPC）</li>
</ul>
<p>ただ、スケジューラ機能は無いので、 cron ジョブで実行するなどが必要になる。</p>
<h2 ref="bigtable" >Bigtable</h2><a class="anchor" id="bigtable"></a>
<h3 ref="bigtable-インスタンスの変更" >Bigtable インスタンスの変更</h3><a class="anchor" id="bigtable-インスタンスの変更"></a>
<p>以下の場合、ダウンタイム無しで設定を変更できる。</p>
<ul>
<li>各クラスタのノードの数</li>
<li>インスタンス内のクラスタの数</li>
<li>インスタンスのアプリ プロファイル（レプリケーション設定が含まれている）</li>
<li>インスタンスのラベル（インスタンスに関するメタデータを提供する）</li>
<li>インスタンスの表示名</li>
<li>開発インスタンスから本番インスタンスへのアップグレード</li>
</ul>
<p>ただし、以下を変更する場合は、Bigtable インスタンスを新たに作成し、データを移行する必要がある。</p>
<ul>
<li>インスタンス ID</li>
<li>ストレージ タイプ（SSD または HDD）</li>
<li>顧客管理の暗号鍵（CMEK）の構成</li>
</ul>
<p>移行の方法としては、Dataflowを使用して古いBigTableインスタンスから新しいインスタンスにデータを移行するなどがあげられる。</p>
<h3 ref="ストレージの選択" >ストレージの選択</h3><a class="anchor" id="ストレージの選択"></a>
<p>Bigtable では HDD または SSD のストレージを選択することができる。<br>
選択基準は以下の通り。</p>
<ul>
<li>HDD
<ul>
<li>非常に大きいデータセット（10 TB 超）で、レイテンシがあまり重要でない場合やアクセス頻度が低い場合に適切</li>
<li>バッチやデータアーカイブなど</li>
</ul>
</li>
<li>SSD
<ul>
<li>ほとんどのユースケースで最も効率的でコスト効果の高い選択肢</li>
</ul>
</li>
</ul>
<h3 ref="レプリケーション" >レプリケーション</h3><a class="anchor" id="レプリケーション"></a>
<p>クラスタ単位のレプリケーションをするみたい。驚き。（ <a href="https://cloud.google.com/bigtable/docs/replication-overview">参考</a> ）</p>
<h3 ref="パフォーマンステスト" >パフォーマンステスト</h3><a class="anchor" id="パフォーマンステスト"></a>
<p>Bigtable でパフォーマンステストを実施する場合は以下の点に留意する。</p>
<ul>
<li>十分なデータでテストする
<ul>
<li>ノードあたり 100 GB 以上
<ul>
<li>ただし、 3 ノード以上でクラスタ化されているので 300 GB 以上</li>
</ul>
</li>
</ul>
</li>
<li>単一のテーブルでテストする</li>
<li>ノードあたりの推奨ストレージ使用率を超えないように</li>
<li>テスト前に、負荷の大きな事前テストを数分間実行
<ul>
<li>データ配置が最適化される</li>
</ul>
</li>
<li>最低 10 分間テストを実行
<ul>
<li>データをさらに最適化するので、ディスクからの読み取りだけでなく、メモリからのキャッシュ経由の読み取りも確実にテストできる</li>
</ul>
</li>
</ul>
		</div>






	
	

      </section>

      
      
    </article>
    
    
    <footer>
      

		
	
			
		
	    	
	  	
	
    </footer>
    



  </body>
</html>
